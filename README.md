# dining_philosophers

### Описание
Данный проект реализует задачу об ужинающих философах с использованием многопоточности на языке Python. В классической задаче существует несколько философов, сидящих за круглым столом. Каждый философ имеет доступ к двум вилкам: одна справа и одна слева. Для того чтобы поесть, философу необходимо обладать обеими вилками. Проблема заключается в том, что если все философы одновременно захотят взять вилки, то возникнет взаимоблокировка (deadlock), и никто не сможет поесть.

В этом проекте каждый философ действует в своём потоке, и решение синхронизации доступов к ресурсам (вилкам) выполнено с помощью классов `threading.Condition` для предотвращения взаимоблокировок и гонок данных.

### Структура проекта

1. **Класс Philosopher**:
   - Представляет философа как поток. Философы циклически проходят три состояния: размышление, запрос вилок (левая и правая), еда, после чего освобождают вилки.
   - Каждый философ имеет счётчик приёмов пищи (`eat_count`), который увеличивается, когда философ ест.
   - Важная часть — правильная обработка того, чтобы философ мог взять обе вилки одновременно. Это достигается через вызовы методов `acquire()` и `release()` объекта Fork.

   Методы класса:
   - `think()`: симулирует размышление философа, вызывается пауза в 0.5 секунд.
   - `request_forks()`: философ пытается взять обе вилки (слева и справа). Используются блокировки для правильной синхронизации доступа.
   - `eat()`: философ ест, увеличивается счётчик приёмов пищи.
   - `release_forks()`: философ освобождает вилки, уведомляя другие потоки о доступности вилок.

2. **Класс Fork**:
   - Моделирует вилку, которой может пользоваться один философ в один момент времени.
   - Использует `threading.Condition` для того, чтобы блокировать доступ, если вилка уже занята другим философом.
   - Методы:
     - `acquire(philosopher_index, dirty_flag)`: философ пытается взять вилку.
     - `release(philosopher_index, dirty_flag)`: философ освобождает вилку, делая её доступной для других.

3. **Функция visualize**:
   - Визуализирует результаты симуляции с помощью библиотеки `matplotlib`. По окончании работы программы строится гистограмма, показывающая количество приёмов пищи для каждого философа.
   - Функция строит гистограмму, где на оси X — номера философов, а на оси Y — количество приёмов пищи.

4. **Основной поток программы**:
   - Инициализируются философы и вилки.
   - Стартуют потоки, и симуляция продолжается в течение заданного времени (например, 10 секунд). После этого программа завершает потоки, подсчитывает количество приёмов пищи и строит график.

### Подробное объяснение работы программы

1. **Создание философов и вилок**:
   - Мы задаём количество философов, например, 6. Для каждого философа создаётся поток, в котором философ поочерёдно думает, пытается получить вилки, ест и освобождает вилки. Вилки также создаются как отдельные объекты, доступные философам для использования.

2. **Работа философов**:
   - Каждый философ начинает свою деятельность, постоянно переходя между состояниями "размышляет", "запрашивает вилки", "ест" и "освобождает вилки".
   - Философ не может начать есть, пока не получит обе вилки (слева и справа). Для этого философ "запрашивает" вилки, используя методы `acquire()` класса `Fork`. Если вилка занята, философ ждёт, пока она не будет освобождена другим философом.
   - После того, как философ поел, он освобождает обе вилки, вызывая метод `release()` для каждой из них, чтобы сделать вилки доступными другим философам.

3. **Предотвращение взаимоблокировки**:
   - Для предотвращения взаимоблокировки (deadlock), используются блокировки с условиями (`threading.Condition`). Это позволяет философам корректно взаимодействовать друг с другом и не блокировать стол.

4. **Визуализация результатов**:
   - После завершения симуляции собирается количество приёмов пищи для каждого философа, и создаётся гистограмма с использованием библиотеки `matplotlib`. На графике отображается, сколько раз каждый философ поел за время симуляции.

### Зависимости

Для корректной работы программы необходимо установить следующие библиотеки:
- `matplotlib` — для построения графика с результатами симуляции.

Установка зависимостей:
```bash
pip install matplotlib
```

### Как запустить программу

1. Скачайте код из репозитория и убедитесь, что все необходимые библиотеки установлены.
2. Запустите основной скрипт:
   ```bash
   python main.py
   ```
3. Программа выполнится в течение 10 секунд (можно изменить это время в функции `main()`), после чего будет завершена, а на экране появится график, показывающий результаты.

### Пример работы программы

- Во время выполнения программы, в консоли будет отображаться процесс деятельности философов: когда они думают, запрашивают вилки, едят и освобождают вилки.
- После завершения работы программы будет показана гистограмма, отображающая количество приёмов пищи каждым философом.

### Часть вывода
![image](https://github.com/user-attachments/assets/ed2ac774-2373-42bd-9805-7f461a226a79)


### Результат в виде графика:
После завершения симуляции будет отображён график (гистограмма), где каждая колонка соответствует философу и показывает количество раз, когда этот философ ел.
![image](https://github.com/user-attachments/assets/cdaf31b4-0abe-4e38-8dc1-cef9629145c3)

### Настройки

- **Количество философов**: в программе установлено 6 философов, но вы можете изменить это число в функции `main()`.
- **Время симуляции**: по умолчанию программа работает 10 секунд. Это время можно изменить, отредактировав параметр `time.sleep(10)`.




